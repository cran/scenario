<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Building a reduced scenario tree for multi-stage stochastic programming</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<link href="data:text/css,body%20%7B%0A%20%20background%2Dcolor%3A%20%23fff%3B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20max%2Dwidth%3A%20700px%3B%0A%20%20overflow%3A%20visible%3B%0A%20%20padding%2Dleft%3A%202em%3B%0A%20%20padding%2Dright%3A%202em%3B%0A%20%20font%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0A%20%20font%2Dsize%3A%2014px%3B%0A%20%20line%2Dheight%3A%201%2E35%3B%0A%7D%0A%0A%23header%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0A%0A%23TOC%20%7B%0A%20%20clear%3A%20both%3B%0A%20%20margin%3A%200%200%2010px%2010px%3B%0A%20%20padding%3A%204px%3B%0A%20%20width%3A%20400px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20border%2Dradius%3A%205px%3B%0A%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20font%2Dsize%3A%2013px%3B%0A%20%20line%2Dheight%3A%201%2E3%3B%0A%7D%0A%20%20%23TOC%20%2Etoctitle%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%20%20font%2Dsize%3A%2015px%3B%0A%20%20%20%20margin%2Dleft%3A%205px%3B%0A%20%20%7D%0A%0A%20%20%23TOC%20ul%20%7B%0A%20%20%20%20padding%2Dleft%3A%2040px%3B%0A%20%20%20%20margin%2Dleft%3A%20%2D1%2E5em%3B%0A%20%20%20%20margin%2Dtop%3A%205px%3B%0A%20%20%20%20margin%2Dbottom%3A%205px%3B%0A%20%20%7D%0A%20%20%23TOC%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dleft%3A%20%2D2em%3B%0A%20%20%7D%0A%20%20%23TOC%20li%20%7B%0A%20%20%20%20line%2Dheight%3A%2016px%3B%0A%20%20%7D%0A%0Atable%20%7B%0A%20%20margin%3A%201em%20auto%3B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dcolor%3A%20%23DDDDDD%3B%0A%20%20border%2Dstyle%3A%20outset%3B%0A%20%20border%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0A%20%20border%2Dwidth%3A%202px%3B%0A%20%20padding%3A%205px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0A%20%20border%2Dwidth%3A%201px%3B%0A%20%20border%2Dstyle%3A%20inset%3B%0A%20%20line%2Dheight%3A%2018px%3B%0A%20%20padding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0A%20%20border%2Dleft%2Dstyle%3A%20none%3B%0A%20%20border%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Ap%20%7B%0A%20%20margin%3A%200%2E5em%200%3B%0A%7D%0A%0Ablockquote%20%7B%0A%20%20background%2Dcolor%3A%20%23f6f6f6%3B%0A%20%20padding%3A%200%2E25em%200%2E75em%3B%0A%7D%0A%0Ahr%20%7B%0A%20%20border%2Dstyle%3A%20solid%3B%0A%20%20border%3A%20none%3B%0A%20%20border%2Dtop%3A%201px%20solid%20%23777%3B%0A%20%20margin%3A%2028px%200%3B%0A%7D%0A%0Adl%20%7B%0A%20%20margin%2Dleft%3A%200%3B%0A%7D%0A%20%20dl%20dd%20%7B%0A%20%20%20%20margin%2Dbottom%3A%2013px%3B%0A%20%20%20%20margin%2Dleft%3A%2013px%3B%0A%20%20%7D%0A%20%20dl%20dt%20%7B%0A%20%20%20%20font%2Dweight%3A%20bold%3B%0A%20%20%7D%0A%0Aul%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%7D%0A%20%20ul%20li%20%7B%0A%20%20%20%20list%2Dstyle%3A%20circle%20outside%3B%0A%20%20%7D%0A%20%20ul%20ul%20%7B%0A%20%20%20%20margin%2Dbottom%3A%200%3B%0A%20%20%7D%0A%0Apre%2C%20code%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20color%3A%20%23333%3B%0A%7D%0Apre%20%7B%0A%20%20white%2Dspace%3A%20pre%2Dwrap%3B%20%20%20%20%2F%2A%20Wrap%20long%20lines%20%2A%2F%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20margin%3A%205px%200px%2010px%200px%3B%0A%20%20padding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0A%20%20background%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0A%0Acode%20%7B%0A%20%20font%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0A%20%20font%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0A%20%20padding%3A%202px%200px%3B%0A%7D%0A%0Adiv%2Efigure%20%7B%0A%20%20text%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0A%20%20background%2Dcolor%3A%20%23FFFFFF%3B%0A%20%20padding%3A%202px%3B%0A%20%20border%3A%201px%20solid%20%23DDDDDD%3B%0A%20%20border%2Dradius%3A%203px%3B%0A%20%20border%3A%201px%20solid%20%23CCCCCC%3B%0A%20%20margin%3A%200%205px%3B%0A%7D%0A%0Ah1%20%7B%0A%20%20margin%2Dtop%3A%200%3B%0A%20%20font%2Dsize%3A%2035px%3B%0A%20%20line%2Dheight%3A%2040px%3B%0A%7D%0A%0Ah2%20%7B%0A%20%20border%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20padding%2Dbottom%3A%202px%3B%0A%20%20font%2Dsize%3A%20145%25%3B%0A%7D%0A%0Ah3%20%7B%0A%20%20border%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0A%20%20padding%2Dtop%3A%2010px%3B%0A%20%20font%2Dsize%3A%20120%25%3B%0A%7D%0A%0Ah4%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0A%20%20margin%2Dleft%3A%208px%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Ah5%2C%20h6%20%7B%0A%20%20border%2Dbottom%3A%201px%20solid%20%23ccc%3B%0A%20%20font%2Dsize%3A%20105%25%3B%0A%7D%0A%0Aa%20%7B%0A%20%20color%3A%20%230033dd%3B%0A%20%20text%2Ddecoration%3A%20none%3B%0A%7D%0A%20%20a%3Ahover%20%7B%0A%20%20%20%20color%3A%20%236666ff%3B%20%7D%0A%20%20a%3Avisited%20%7B%0A%20%20%20%20color%3A%20%23800080%3B%20%7D%0A%20%20a%3Avisited%3Ahover%20%7B%0A%20%20%20%20color%3A%20%23BB00BB%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%20%20a%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0A%20%20%20%20text%2Ddecoration%3A%20underline%3B%20%7D%0A%0A%2F%2A%20Class%20described%20in%20https%3A%2F%2Fbenjeffrey%2Ecom%2Fposts%2Fpandoc%2Dsyntax%2Dhighlighting%2Dcss%0A%20%20%20Colours%20from%20https%3A%2F%2Fgist%2Egithub%2Ecom%2Frobsimmons%2F1172277%20%2A%2F%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Keyword%20%2A%2F%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%2F%2A%20DataType%20%2A%2F%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%2F%2A%20DecVal%20%28decimal%20values%29%20%2A%2F%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20BaseN%20%2A%2F%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Float%20%2A%2F%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20Char%20%2A%2F%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%2F%2A%20String%20%2A%2F%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%2F%2A%20Comment%20%2A%2F%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%2F%2A%20OtherToken%20%2A%2F%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20AlertToken%20%2A%2F%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%2F%2A%20Function%20calls%20%2A%2F%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%2F%2A%20ErrorTok%20%2A%2F%0A%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div id="header">
<h1 class="title">Building a reduced scenario tree for multi-stage stochastic programming</h1>
</div>


<p>This aim of this vignette is to introduce you to the neural gas method for scenario reduction, and to show you how to use the <code>buildtree</code> and <code>checktree</code> functions in the <code>scenario</code> package to construct scenario trees with predefined nodal structures. Many optimization problems need to allow for <em>recourse</em> in the contol, or the ability of the operator to change control decisions as uncertainty is reduced through time. Accounting for this in stochastic programming can be achieved by transforming input scenarios of the disturbance into a scenario tree. One way of doing this is by applying the <strong><em>neural gas method</em></strong>. This approach differs from other methods in that it allows the user to predefine and set the nodal structure of the tree.</p>
<div id="what-is-a-scenario-tree" class="section level2">
<h2>What is a scenario tree?</h2>
<p>A scenario tree is a reduced form of an ensemble of scenarios or realizations of a process. The tree clusters those realizations into a set of branches with specified probabilities of occurrence. The tree is made up of <span class="math">\(S\)</span> scenarios, denoted <span class="math">\(s_i\)</span> (<span class="math">\(i = 1, 2,..., S\)</span>). Each scenario contains <span class="math">\(t\)</span> nodes, denoted <span class="math">\(s_{i,t}\)</span> (<span class="math">\(t = 1, 2,..., T\)</span>). At <span class="math">\(t = 1\)</span>, all scenarios in the tree share the same node <span class="math">\(s_{i,1}\)</span>. As <span class="math">\(t\)</span> increases, the tree begins to branch out. When <span class="math">\(t = T\)</span>, all nodes belong to only one scenario. Each scenario has a probability <span class="math">\(P_i\)</span>, and the sum of <span class="math">\(P_i\)</span> across all scenarios is <span class="math">\(1\)</span>.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>The structure of a scenario tree can be represented by a <em>scenario tree nodal partition matrix</em><a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, with the number of columns equal to the number of scenarios (4 in the above case) and the number of rows equal to the number of time steps (3 in the above case). This form of matrix is entered into the <code>buildtree</code> and <code>checktree</code> functions of the <code>scenario</code> package using the <code>treeStruct</code> parameter.</p>
<p>For the simple example given above, the nodes are:</p>
<pre><code>##      [,1]    [,2]    [,3]    [,4]   
## [1,] &quot;S_1,1&quot; &quot;S_2,1&quot; &quot;S_3,1&quot; &quot;S_4,1&quot;
## [2,] &quot;S_1,2&quot; &quot;S_2,2&quot; &quot;S_3,2&quot; &quot;S_4,2&quot;
## [3,] &quot;S_1,3&quot; &quot;S_2,3&quot; &quot;S_3,3&quot; &quot;S_4,3&quot;</code></pre>
<p>Since all scenarios at <span class="math">\(t = 1\)</span> share the same node, we can state that <span class="math">\(S_{1,1} = S_{2,1} = S_{3,1} = S_{4,1}\)</span>. Similarly, <span class="math">\(S_{1,2} = S_{2,2}\)</span> and <span class="math">\(S_{3,2} = S_{4,2}\)</span>. Thus, the associated scenario tree nodal partition matrix can be written as:</p>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    1    1    1
## [2,]    2    2    5    5
## [3,]    3    4    6    7</code></pre>
<p>The easiest way to write this matrix is go column by column, raising the node integer by 1 for each node that has not already been defined. After writing a tree structure matrix, you can check if it is correct using the <code>checktree</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r">treeStruct &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),
                    <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>),
                    <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>))
scenario::<span class="kw">checktree</span>(treeStruct)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>If then you feel that the tree requires more or less complexity, simply alter and recheck before using the structure in the <code>buildtree</code> function. For example:</p>
<pre class="sourceCode r"><code class="sourceCode r">treeStruct &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),
                    <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">11</span>),
                    <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">12</span>))
scenario::<span class="kw">checktree</span>(treeStruct)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
</div>
<div id="the-neural-gas-method-for-scenario-reduction" class="section level2">
<h2>The neural gas method for scenario reduction</h2>
<p>(<em>Note that the following steps are set out solely to illustrate what the <code>buildtree</code> function does—you can start to build trees without this in-depth knowledge by simply running the function, which is described in the next section.</em>)</p>
<p>From <a href="https://en.wikipedia.org/wiki/Neural_gas">Wikipedia</a>:</p>
<blockquote>
<p>The neural gas is a simple algorithm for finding optimal data representations based on feature vectors. The algorithm was coined “neural gas” because of the dynamics of the feature vectors during the adaptation process, which distribute themselves like a gas within the data space.</p>
</blockquote>
<p>The neural gas algorithm can be used to define the node values (and scenario probabilites) of a given scenario tree structure to best describe a set of input scenarios (which we will term “realizations” to distinguish from the scenarios belonging to the scenario tree). When applied to generation of a scenario tree with a predefined nodal structure, the neural gas algorithm requires three types of input. First, we need an initial set of realizations of length <span class="math">\(T\)</span>, which we will term <span class="math">\(X\)</span> (<span class="math">\(X\)</span> may be an ensemble of forecasts, or simply a record of historical observed disturbances). Second, we need to define the desired scenario tree structure and then code it as a scenario tree nodal partition matrix, as described above. Third, we need some input parameters that define the resolution of the iterations taken by the algorithm. These are defaulted to recommended values in the <code>buildtree</code> function; the <code>jMax</code> parameter can be altered to trade off accurracy and computation time.</p>
<p>The following steps walk through the algorithm using a simple, stylized example. Here we generate the realizations artificially from a known tree, so as to illustrate the efficacy of the algorithm.</p>
<pre class="sourceCode r"><code class="sourceCode r">known_tree &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>),
                   <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>),
                   <span class="kw">c</span>(<span class="dv">0</span>,-<span class="dv">2</span>,-<span class="dv">3</span>),
                   <span class="kw">c</span>(<span class="dv">0</span>,-<span class="dv">2</span>,-<span class="dv">1</span>)
                   )
<span class="co"># now add some noise to the known tree...</span>
realizations &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(known_tree,<span class="dv">5</span>), <span class="dt">ncol=</span><span class="dv">20</span>) +<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">60</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span><span class="dv">20</span>)
<span class="kw">matplot</span>(realizations, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,
        <span class="dt">ylab =</span> <span class="st">&quot;Disturbance&quot;</span>, <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Initial realizations&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span>:<span class="dv">3</span>, <span class="dt">labels=</span><span class="dv">1</span>:<span class="dv">3</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<div id="step-1.-initialize-the-scenario-tree" class="section level4">
<h4>Step 1. Initialize the scenario tree</h4>
<p>To initialize the tree before running the iterations, the tree nodes must be given an initial values. Exactly what these values are is relatively unimportant, since the algorithm will quickly perturb the tree as it begins to fit it to the realizations. A simple way to initialize the tree is to assign each scenario the value of a randomly selected realization, <span class="math">\(X_k\)</span> (<span class="math">\(k = 1, 2, ..., K\)</span>; <span class="math">\(K\)</span> is the total number of realizations—20 in the example given above). Averages are then taken to give nodes belonging to more than one scenario the same value, which ensures that the scenario tree structure is maintained. An example of an initial tree position is given below.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>The following parameters are set before beginning the iterative procedure:</p>
<p><span class="math">\(\lambda_0\)</span> <span class="math">\((= 10)\)</span></p>
<p><span class="math">\(\lambda_f\)</span> <span class="math">\((= 0.01)\)</span></p>
<p><span class="math">\(\epsilon_0\)</span> <span class="math">\((= 0.5)\)</span></p>
<p><span class="math">\(\epsilon_f\)</span> <span class="math">\((=0.05)\)</span></p>
<p><span class="math">\(j_{max}\)</span> <span class="math">\((=40000)\)</span></p>
<p>The brackets give the <code>buildtree</code> default values. Once the tree is initialized, an iteration counter <span class="math">\(j\)</span> is set to 1.</p>
</div>
<div id="step-2.-weight-by-euclidean-distance-order" class="section level4">
<h4>Step 2. Weight by Euclidean distance order</h4>
<p>Each iteration of the neural gas procedure begins with the random selection of a realization <span class="math">\(X_k\)</span> from <span class="math">\(X\)</span>. An example is given below, with the selected realization shown as a thick black dashed line.</p>
<p><img src="data:image/png;base64,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" /></p>
<p>The algorithm aims to determine which of the scenarios in the tree are most likely to represent the randomly chosen realization, and then move the scenarios according to those likelihoods. This is achieved by weighting each scenario according to its distance from the randomly chosen realization. To do this, we compute the Euclidean distances from the realization <span class="math">\(X_k\)</span> to each scenario (<span class="math">\(s_i\)</span>, <span class="math">\(i = 1, 2, ..., S\)</span>) using:</p>
<p><span class="math">\(d_{i,k} = \sqrt{\sum_{t=1}^{T} (s_{i,t} - X_{k,t})^{2}}\)</span></p>
<p>To weight the scenarios, we use the rank of the distances. To exemplify, the Euclidean distances and scenario ranks for our simple example are:</p>
<pre><code>##      Euclidean_distances Rank
## [1,]            2.122578    1
## [2,]            4.149948    4
## [3,]            2.323245    2
## [4,]            2.786486    3</code></pre>
<p>The ranks are stored in vector <span class="math">\(R\)</span> for use in the following step. Those scenarios with the lowest rank (i.e., closest to the realization) will be perturbed most toward the realization. As the process iterates with new randomly chosen values, the tree will begin to spread out with each scenario moving toward the realizations it is most likely to represent.</p>
</div>
<div id="node-adjustment" class="section level4">
<h4>3. Node adjustment</h4>
<p>We adjust the value of each node turn according to the following equation:</p>
<p><span class="math">\(\Delta s_{i,t} = \epsilon(j) \cdot \sum_{i'} h(R_{i'}, \lambda(j)) \cdot (X_{k,t} - s_{i',t}) / \sum_{i'} 1\)</span></p>
<p>where <span class="math">\(i'\)</span> indexes through the scenarios that pass through node <span class="math">\(s_{i,t}\)</span> (for example, four scenarios pass through the first node of the simple tree above, so the equation sums for all four scenario ranks when applied to this node.</p>
<p><span class="math">\(\epsilon(j) = \epsilon_0 \cdot (\epsilon_f/\epsilon_0)^{j/j_{max}}\)</span></p>
<p><span class="math">\(h(R_{i'}, \lambda(j)) = e^{-R_{i'}/\lambda(j)}\)</span></p>
<p><span class="math">\(\lambda(j) = \lambda_0 \cdot (\lambda_f/\lambda_0)^{j/j_{max}}\)</span></p>
</div>
<div id="iterate" class="section level4">
<h4>4. Iterate</h4>
<p>After each node is adjusted (by adding <span class="math">\(\Delta s_{i,t}\)</span> to the previous value <span class="math">\(s_{i,t}\)</span>), we add 1 to <span class="math">\(j\)</span> and start the process again from step 2. The iteration is completed when <span class="math">\(j = j_{max}\)</span>.</p>
</div>
<div id="compute-probabilites" class="section level4">
<h4>5. Compute probabilites</h4>
<p>Once the scenario tree has converged, the probabilities of each scenario are computed by assigning to each scenario a realization, based on lowest Euclidean distance. Assuming all realizations are equiprobably, the probability of any scenario is simply the proportion of total realizations that lie closer to it than any other scenario.</p>
</div>
</div>
<div id="building-scenario-trees-with-buildtree" class="section level2">
<h2>Building scenario trees with <code>buildtree</code></h2>
<p>The neural gas algorithm can be executed easily using the <code>buildtree</code> function in scenario. The code below inputs the realizations and tree structure for the simple example case above. <span class="math">\(j_{max}\)</span> is set to 1000 for efficiency; a more representative tree can be found by increasing <span class="math">\(j_{max}\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r">scenario::<span class="kw">buildtree</span>(realizations, treeStruct, <span class="dt">jMax =</span> <span class="dv">1000</span>)</code></pre>
<pre><code>## $tree_structure
##      [,1] [,2] [,3] [,4]
## [1,]    1    1    1    1
## [2,]    2    2    5    5
## [3,]    3    4    6    7
## 
## $tree_values
##            [,1]        [,2]      [,3]      [,4]
## [1,]  0.2476745  0.24767448 0.2476745 0.2476745
## [2,] -1.5126028 -1.51260276 1.9245998 1.9245998
## [3,] -1.8169913  0.03721561 2.6616859 0.8105466
## 
## $branch_probabilities
## [1] 0.35 0.15 0.35 0.15</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matlines</span>(known_tree, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</code></pre>
<p><img src="data:image/png;base64,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" /></p>
<p>Note that the function returns a list with three objects: the initial desired tree structure; the values of the final tree nodes, and the probabilities of each scenario of the tree. The figure compares the final tree against the known tree from which the realizations were generated.</p>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>see <a href="http://www.karlin.mff.cuni.cz/~dupacova/papers/vanc-ed.pdf">Dupacova et al. (2000)</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
